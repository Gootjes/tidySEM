<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generating syntax for structural equation models • tidySEM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Generating syntax for structural equation models">
<meta property="og:description" content="tidySEM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidySEM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Generating_syntax.html">Generating syntax for structural equation models</a>
    </li>
    <li>
      <a href="../articles/lca_confirmatory.html">Confirmatory LPA for the Caregiver Compass</a>
    </li>
    <li>
      <a href="../articles/lca_exploratory.html">Exploratory LPA for Ocean Microplastics</a>
    </li>
    <li>
      <a href="../articles/lca_lcga.html">Latent Class Growth Analysis</a>
    </li>
    <li>
      <a href="../articles/lca_ordinal.html">Latent Class Analysis for Ordinal Indicators</a>
    </li>
    <li>
      <a href="../articles/Plotting_graphs.html">Plotting graphs for structural equation models</a>
    </li>
    <li>
      <a href="../articles/sem_graph.html">SEM graphing conventions</a>
    </li>
    <li>
      <a href="../articles/SMART_LCA_checklist.html">`r paste0("SMART-LCA Checklist, version ", packageVersion("tidySEM"))`</a>
    </li>
    <li>
      <a href="../articles/Tabulating_results.html">Tabulating results from structural equation models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cjvanlissa/tidySEM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Generating syntax for structural equation
models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cjvanlissa/tidySEM/blob/HEAD/vignettes/Generating_syntax.Rmd" class="external-link"><code>vignettes/Generating_syntax.Rmd</code></a></small>
      <div class="hidden name"><code>Generating_syntax.Rmd</code></div>

    </div>

    
    
<p><code>tidySEM</code> offers a user-friendly, tidy workflow for
generating syntax for SEM models. The workflow is top-down, meaning that
syntax is generated based on conceptual model elements. In many cases,
the generated syntax will suffice - but it is always customizable. The
workflow also tries to intelligently guess which variables go together,
but these defaults can be overridden.</p>
<div class="section level2">
<h2 id="the-tidysem-workflow">The tidySEM workflow<a class="anchor" aria-label="anchor" href="#the-tidysem-workflow"></a>
</h2>
<p>The workflow underlying syntax generation in <code>tidySEM</code> is
as follows:</p>
<ol style="list-style-type: decimal">
<li>Give the variables in your <code>data</code> object short,
informative names, that are easily machine readable</li>
<li>Convert the data to a <code>tidy_sem</code> object by running
<code>model &lt;- tidy_sem(data)</code>
<!--    * The `data_dictionary` called `dict` can be used to generate `keys(dict)`, for use with functions (reliability, factor analysis) from the `psych` library
    * The `data_dictionary` called `dict` can be used to generate syntax for structural equation models in `lavaan` or 'Mplus' (through `MplusAutomation`)-->
</li>
<li>Add elements of syntax
<ul>
<li>E.g., <code>measurement(model)</code>
</li>
</ul>
</li>
<li>
<em>Optionally</em>, access the <code>dictionary</code>,
<code>data</code>, and <code>syntax</code> elements in the
<code>tidy_sem</code> object by calling <code>dictionary(model)</code>,
<code>get_data(model)</code>, or <code>syntax(model)</code>
</li>
<li>
<em>Optionally</em>, modify the <code>dictionary</code>,
<code>data</code>, and <code>syntax</code> elements in the
<code>tidy_sem</code> object <code>dictionary(model) &lt;- ...</code>,
<code>get_data(model) &lt;- ...</code>, and
<code>syntax(model) &lt;- ...</code>
</li>
<li>Run the analysis, either by:
<ul>
<li>Converting the <code>tidy_sem</code> object to <code>lavaan</code>
syntax using <code>as_lavaan(model)</code> and using that as input for
the <code>lavaan</code> functions <code>sem</code>, <code>lavaan</code>,
or <code>cfa</code>
</li>
<li>Converting the <code>tidy_sem</code> object to <code>OpenMx</code>
using <code>as_ram(model)</code>, and using that as input for
<code>mxRun</code> or `run_mx``</li>
<li>Converting the <code>tidy_sem</code> object to <code>Mplus</code>
using <code>as_mplus(model)</code>, and using that as input for
<code><a href="https://michaelhallquist.github.io/MplusAutomation/reference/mplusObject.html" class="external-link">MplusAutomation::mplusObject()</a></code>
</li>
<li>Using the functions <code>estimate_lavaan(model)</code>,
<code>estimate_mx(model)</code>, or
<code>estimate_mplus(model)</code>
</li>
</ul>
</li>
</ol>
<p>All elements of the <code>tidy_sem</code> object are “tidy” data,
i.e., tabular <code>data.frames</code>, and can be modified using the
familiar suite of functions in the ‘tidyverse’. Thus, the data,
dictionary, and syntax are all represented as
<code>data.frame</code>s.</p>
</div>
<div class="section level2">
<h2 id="example-running-a-cfa">Example: Running a CFA<a class="anchor" aria-label="anchor" href="#example-running-a-cfa"></a>
</h2>
<div class="section level3">
<h3 id="step-1-check-the-variable-names">Step 1: Check the variable names<a class="anchor" aria-label="anchor" href="#step-1-check-the-variable-names"></a>
</h3>
<p>As an example, let’s make a graph for a classic <code>lavaan</code>
tutorial example for CFA. First, we check the data names:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">HolzingerSwineford1939</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "id"     "sex"    "ageyr"  "agemo"  "school" "grade"  "x1"     "x2"    </span></span>
<span><span class="co">#&gt;  [9] "x3"     "x4"     "x5"     "x6"     "x7"     "x8"     "x9"</span></span></code></pre></div>
<p>These names are not informative, as the items named <code>x..</code>
are indicators of three different latent variables. We will rename them
accordingly:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^x"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vis_1"</span>, <span class="st">"vis_2"</span>, <span class="st">"vis_3"</span>, <span class="st">"tex_1"</span>, <span class="st">"tex_2"</span>, <span class="st">"tex_3"</span>, <span class="st">"spe_1"</span>, <span class="st">"spe_2"</span>, <span class="st">"spe_3"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="guidelines-for-naming-variables">Guidelines for naming variables<a class="anchor" aria-label="anchor" href="#guidelines-for-naming-variables"></a>
</h3>
<p>In general, it is good practice to name variables using the following
information:</p>
<ul>
<li>Scale name (or if the variable is not part of a scale, observed
variable name)</li>
<li>Measurement occasion (if longitudinal)</li>
<li>Respondent id (if multiple respondents completed the same
scales)</li>
<li>Scale item number, which <code>tidySEM</code> expects to be
separated from the remainder of the variable name by a splitting
character (e.g., <code>scale_item</code>)</li>
</ul>
<p>Roughly speaking, elements of the variable name should be ordered
from “slow-changing” to “fast-changing”; i.e.; there are only a few
scales, with possibly several measurement occasions or respondents, and
many items.</p>
</div>
<div class="section level3">
<h3 id="step-2-generate-a-dictionary">Step 2: Generate a dictionary<a class="anchor" aria-label="anchor" href="#step-2-generate-a-dictionary"></a>
</h3>
<p>A dictionary indicates which variables in the data belong to, for
example, the same scale. When the data have informative names, it is
possible to construct a data dictionary automatically:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy_sem.html">tidy_sem</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">model</span></span>
<span><span class="co">#&gt; A tidy_sem object</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v  </span>  $dictionary</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v  </span>  $data</span></span>
<span><span class="co">#&gt; <span style="color: #BBBBBB;">o  </span>  $syntax</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-3-generate-syntax">Step 3: Generate syntax<a class="anchor" aria-label="anchor" href="#step-3-generate-syntax"></a>
</h3>
<p>We can automatically add basic syntax to the <code>sem_syntax</code>
object, by passing it to a syntax-generating function like
<code><a href="../reference/measurement.html">measurement()</a></code>, which adds a measurement model for any
scales in the object:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/measurement.html">measurement</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">model</span></span>
<span><span class="va">model</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; A tidy_sem object</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v  </span>  $dictionary</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v  </span>  $data</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v  </span>  $syntax</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="step-4-run-the-model">Step 4: Run the model<a class="anchor" aria-label="anchor" href="#step-4-run-the-model"></a>
</h3>
<p>The resulting model can be evaluated as ‘lavaan’ syntax, ‘OpenMx’
syntax, or ‘Mplus’ syntax, using the <code>as_lavaan</code>,
<code>as_ram</code>, and <code>as_mplus</code> functions. For example,
using lavaan:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/estimate_lavaan.html">estimate_lavaan</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; lavaan 0.6.15 ended normally after 35 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        30</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                           301</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                                85.306</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                24</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span></code></pre>
<p>The same model can be estimated in ‘Mplus’ through the R-package
<code>MplusAutomation</code>. This requires ‘Mplus’ to be installed.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/estimate_mx.html">estimate_mx</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The same model can be estimated in ‘Mplus’ through the R-package
<code>MplusAutomation</code>. This requires ‘Mplus’ to be installed.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://michaelhallquist.github.io/MplusAutomation/" class="external-link">MplusAutomation</a></span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/estimate_mplus.html">estimate_mplus</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="optional-step-5-access-the-dictionary-data-and-syntax">Optional step 5: Access the dictionary, data, and syntax<a class="anchor" aria-label="anchor" href="#optional-step-5-access-the-dictionary-data-and-syntax"></a>
</h3>
<p>The dictionary and syntax can be examined using
<code>dictionary(model)</code> and <code>syntax(model)</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dictionary.html">dictionary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt;      name scale      type  label</span></span>
<span><span class="co">#&gt; 1      id  &lt;NA&gt;  observed     id</span></span>
<span><span class="co">#&gt; 2     sex  &lt;NA&gt;  observed    sex</span></span>
<span><span class="co">#&gt; 3   ageyr  &lt;NA&gt;  observed  ageyr</span></span>
<span><span class="co">#&gt; 4   agemo  &lt;NA&gt;  observed  agemo</span></span>
<span><span class="co">#&gt; 5  school  &lt;NA&gt;  observed school</span></span>
<span><span class="co">#&gt; 6   grade  &lt;NA&gt;  observed  grade</span></span>
<span><span class="co">#&gt; 7   vis_1   vis indicator  vis_1</span></span>
<span><span class="co">#&gt; 8   vis_2   vis indicator  vis_2</span></span>
<span><span class="co">#&gt; 9   vis_3   vis indicator  vis_3</span></span>
<span><span class="co">#&gt; 10  tex_1   tex indicator  tex_1</span></span>
<span><span class="co">#&gt; 11  tex_2   tex indicator  tex_2</span></span>
<span><span class="co">#&gt; 12  tex_3   tex indicator  tex_3</span></span>
<span><span class="co">#&gt; 13  spe_1   spe indicator  spe_1</span></span>
<span><span class="co">#&gt; 14  spe_2   spe indicator  spe_2</span></span>
<span><span class="co">#&gt; 15  spe_3   spe indicator  spe_3</span></span>
<span><span class="co">#&gt; 16    vis  &lt;NA&gt;    latent    vis</span></span>
<span><span class="co">#&gt; 17    tex  &lt;NA&gt;    latent    tex</span></span>
<span><span class="co">#&gt; 18    spe  &lt;NA&gt;    latent    spe</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/syntax.html">syntax</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt;      lhs op   rhs block group free label ustart plabel</span></span>
<span><span class="co">#&gt; 1    vis =~ vis_1     1     1    0            1   .p1.</span></span>
<span><span class="co">#&gt; 2    vis =~ vis_2     1     1    1           NA   .p2.</span></span>
<span><span class="co">#&gt; 3    vis =~ vis_3     1     1    1           NA   .p3.</span></span>
<span><span class="co">#&gt; 4    tex =~ tex_1     1     1    0            1   .p4.</span></span>
<span><span class="co">#&gt; 5    tex =~ tex_2     1     1    1           NA   .p5.</span></span>
<span><span class="co">#&gt; 6    tex =~ tex_3     1     1    1           NA   .p6.</span></span>
<span><span class="co">#&gt; 7    spe =~ spe_1     1     1    0            1   .p7.</span></span>
<span><span class="co">#&gt; 8    spe =~ spe_2     1     1    1           NA   .p8.</span></span>
<span><span class="co">#&gt; 9    spe =~ spe_3     1     1    1           NA   .p9.</span></span>
<span><span class="co">#&gt; 10 vis_1 ~~ vis_1     1     1    1           NA  .p10.</span></span>
<span><span class="co">#&gt; 11 vis_2 ~~ vis_2     1     1    1           NA  .p11.</span></span>
<span><span class="co">#&gt; 12 vis_3 ~~ vis_3     1     1    1           NA  .p12.</span></span>
<span><span class="co">#&gt; 13 tex_1 ~~ tex_1     1     1    1           NA  .p13.</span></span>
<span><span class="co">#&gt; 14 tex_2 ~~ tex_2     1     1    1           NA  .p14.</span></span>
<span><span class="co">#&gt; 15 tex_3 ~~ tex_3     1     1    1           NA  .p15.</span></span>
<span><span class="co">#&gt; 16 spe_1 ~~ spe_1     1     1    1           NA  .p16.</span></span>
<span><span class="co">#&gt; 17 spe_2 ~~ spe_2     1     1    1           NA  .p17.</span></span>
<span><span class="co">#&gt; 18 spe_3 ~~ spe_3     1     1    1           NA  .p18.</span></span>
<span><span class="co">#&gt; 19   vis ~~   vis     1     1    1           NA  .p19.</span></span>
<span><span class="co">#&gt; 20   tex ~~   tex     1     1    1           NA  .p20.</span></span>
<span><span class="co">#&gt; 21   spe ~~   spe     1     1    1           NA  .p21.</span></span>
<span><span class="co">#&gt; 22   vis ~~   tex     1     1    1           NA  .p22.</span></span>
<span><span class="co">#&gt; 23   vis ~~   spe     1     1    1           NA  .p23.</span></span>
<span><span class="co">#&gt; 24   tex ~~   spe     1     1    1           NA  .p24.</span></span>
<span><span class="co">#&gt; 25 vis_1 ~1           1     1    1           NA  .p25.</span></span>
<span><span class="co">#&gt; 26 vis_2 ~1           1     1    1           NA  .p26.</span></span>
<span><span class="co">#&gt; 27 vis_3 ~1           1     1    1           NA  .p27.</span></span>
<span><span class="co">#&gt; 28 tex_1 ~1           1     1    1           NA  .p28.</span></span>
<span><span class="co">#&gt; 29 tex_2 ~1           1     1    1           NA  .p29.</span></span>
<span><span class="co">#&gt; 30 tex_3 ~1           1     1    1           NA  .p30.</span></span>
<span><span class="co">#&gt; 31 spe_1 ~1           1     1    1           NA  .p31.</span></span>
<span><span class="co">#&gt; 32 spe_2 ~1           1     1    1           NA  .p32.</span></span>
<span><span class="co">#&gt; 33 spe_3 ~1           1     1    1           NA  .p33.</span></span>
<span><span class="co">#&gt; 34   vis ~1           1     1    0            0  .p34.</span></span>
<span><span class="co">#&gt; 35   tex ~1           1     1    0            0  .p35.</span></span>
<span><span class="co">#&gt; 36   spe ~1           1     1    0            0  .p36.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="optional-step-6-modify-the-dictionary-and-syntax">Optional step 6: Modify the dictionary and syntax<a class="anchor" aria-label="anchor" href="#optional-step-6-modify-the-dictionary-and-syntax"></a>
</h3>
<p>At this stage, we may want to modify the basic syntax slightly. The
functions <code>dictionary(model) &lt;- ...</code> and
<code>syntax(model) &lt;- ...</code> can be used to modify the
dictionary and syntax:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dictionary.html">dictionary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">label</span> <span class="op">==</span> <span class="st">"vis"</span>, <span class="st">"Visual"</span>, <span class="va">label</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;      name scale      type  label</span></span>
<span><span class="co">#&gt; 1      id  &lt;NA&gt;  observed     id</span></span>
<span><span class="co">#&gt; 2     sex  &lt;NA&gt;  observed    sex</span></span>
<span><span class="co">#&gt; 3   ageyr  &lt;NA&gt;  observed  ageyr</span></span>
<span><span class="co">#&gt; 4   agemo  &lt;NA&gt;  observed  agemo</span></span>
<span><span class="co">#&gt; 5  school  &lt;NA&gt;  observed school</span></span>
<span><span class="co">#&gt; 6   grade  &lt;NA&gt;  observed  grade</span></span>
<span><span class="co">#&gt; 7   vis_1   vis indicator  vis_1</span></span>
<span><span class="co">#&gt; 8   vis_2   vis indicator  vis_2</span></span>
<span><span class="co">#&gt; 9   vis_3   vis indicator  vis_3</span></span>
<span><span class="co">#&gt; 10  tex_1   tex indicator  tex_1</span></span>
<span><span class="co">#&gt; 11  tex_2   tex indicator  tex_2</span></span>
<span><span class="co">#&gt; 12  tex_3   tex indicator  tex_3</span></span>
<span><span class="co">#&gt; 13  spe_1   spe indicator  spe_1</span></span>
<span><span class="co">#&gt; 14  spe_2   spe indicator  spe_2</span></span>
<span><span class="co">#&gt; 15  spe_3   spe indicator  spe_3</span></span>
<span><span class="co">#&gt; 16    vis  &lt;NA&gt;    latent Visual</span></span>
<span><span class="co">#&gt; 17    tex  &lt;NA&gt;    latent    tex</span></span>
<span><span class="co">#&gt; 18    spe  &lt;NA&gt;    latent    spe</span></span></code></pre>
<p>For example, imagine we want to change the model, so that all items
of the “spe” subscale load on the “tex” latent variable. We would first
replace the latent variable “spe” with “tex”, and secondly remove all
mention of the “spe” latent variable:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/syntax.html">syntax</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>lhs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">lhs</span> <span class="op">==</span> <span class="st">"spe"</span> <span class="op">&amp;</span> <span class="va">op</span> <span class="op">==</span> <span class="st">"=~"</span>, <span class="st">"tex"</span>, <span class="va">lhs</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">lhs</span> <span class="op">==</span> <span class="st">"spe"</span> <span class="op">|</span> <span class="va">rhs</span> <span class="op">==</span> <span class="st">"spe"</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="fu"><a href="../reference/syntax.html">syntax</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<p>The modified model could then be run:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate_lavaan.html">estimate_lavaan</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6.15 ended normally after 28 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        27</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                           301</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                               330.994</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                27</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="optional-step-7-adding-paths">Optional step 7: Adding paths<a class="anchor" aria-label="anchor" href="#optional-step-7-adding-paths"></a>
</h3>
<p>In addition to the way of editing the <code>data.frame</code> with
model syntax described in Step 6, it is also possible to add (or modify)
paths by adding <code>lavaan</code> syntax. For example, imagine that -
instead of having “vis” and “tex” correlate, we want to add a regression
path between them:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_paths.html">add_paths</a></span><span class="op">(</span><span class="st">"vis ~ tex"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/estimate_lavaan.html">estimate_lavaan</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span>estimates <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; lavaan 0.6.15 ended normally after 27 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        27</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                           301</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                               330.994</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                27</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   vis =~                                              </span></span>
<span><span class="co">#&gt;     vis_1             1.000                           </span></span>
<span><span class="co">#&gt;     vis_2             0.558    0.104    5.361    0.000</span></span>
<span><span class="co">#&gt;     vis_3             0.711    0.116    6.143    0.000</span></span>
<span><span class="co">#&gt;   tex =~                                              </span></span>
<span><span class="co">#&gt;     tex_1             1.000                           </span></span>
<span><span class="co">#&gt;     tex_2             1.448    0.099   14.657    0.000</span></span>
<span><span class="co">#&gt;     tex_3             1.234    0.084   14.696    0.000</span></span>
<span><span class="co">#&gt;     spe_1             1.000                           </span></span>
<span><span class="co">#&gt;     spe_2             0.319    0.083    3.860    0.000</span></span>
<span><span class="co">#&gt;     spe_3             0.437    0.082    5.326    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   vis ~                                               </span></span>
<span><span class="co">#&gt;     tex               0.591    0.092    6.408    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;    .vis_1             4.936    0.067   73.473    0.000</span></span>
<span><span class="co">#&gt;    .vis_2             6.088    0.068   89.855    0.000</span></span>
<span><span class="co">#&gt;    .vis_3             2.250    0.065   34.579    0.000</span></span>
<span><span class="co">#&gt;    .tex_1             3.061    0.060   51.280    0.000</span></span>
<span><span class="co">#&gt;    .tex_2             4.341    0.074   58.452    0.000</span></span>
<span><span class="co">#&gt;    .tex_3             2.186    0.063   34.667    0.000</span></span>
<span><span class="co">#&gt;    .spe_1             4.186    0.080   52.359    0.000</span></span>
<span><span class="co">#&gt;    .spe_2             5.527    0.058   94.854    0.000</span></span>
<span><span class="co">#&gt;    .spe_3             5.374    0.058   92.546    0.000</span></span>
<span><span class="co">#&gt;    .vis               0.000                           </span></span>
<span><span class="co">#&gt;     tex               0.000                           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;    .vis_1             0.538    0.126    4.280    0.000</span></span>
<span><span class="co">#&gt;    .vis_2             1.127    0.102   11.006    0.000</span></span>
<span><span class="co">#&gt;    .vis_3             0.860    0.094    9.151    0.000</span></span>
<span><span class="co">#&gt;    .tex_1             0.512    0.050   10.281    0.000</span></span>
<span><span class="co">#&gt;    .tex_2             0.485    0.065    7.447    0.000</span></span>
<span><span class="co">#&gt;    .tex_3             0.343    0.047    7.335    0.000</span></span>
<span><span class="co">#&gt;    .spe_1             1.364    0.118   11.587    0.000</span></span>
<span><span class="co">#&gt;    .spe_2             0.965    0.079   12.160    0.000</span></span>
<span><span class="co">#&gt;    .spe_3             0.908    0.075   12.055    0.000</span></span>
<span><span class="co">#&gt;    .vis               0.625    0.134    4.673    0.000</span></span>
<span><span class="co">#&gt;     tex               0.560    0.073    7.638    0.000</span></span></code></pre>
<p>This function accepts both quoted (character) and unquoted arguments.
So, for example, if we want to add a cross-loading from “spe_1” on
“vis”, in addition to the regression path before, we could use the
following code:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_paths.html">add_paths</a></span><span class="op">(</span><span class="st">"vis ~ tex"</span>, vis <span class="op">=</span><span class="op">~</span> <span class="va">spe_1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/estimate_lavaan.html">estimate_lavaan</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Warning in lav_object_post_check(object): lavaan WARNING: some estimated ov</span></span>
<span><span class="co">#&gt; variances are negative</span></span>
<span><span class="co">#&gt; lavaan 0.6.15 ended normally after 64 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        27</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                           301</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                               407.730</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                27</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span></code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Caspar J. van Lissa.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
