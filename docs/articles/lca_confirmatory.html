<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Confirmatory LPA for the Caregiver Compass â€¢ tidySEM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Confirmatory LPA for the Caregiver Compass">
<meta property="og:description" content="tidySEM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidySEM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Generating_syntax.html">Generating syntax for structural equation models</a>
    </li>
    <li>
      <a href="../articles/lca_confirmatory.html">Confirmatory LPA for the Caregiver Compass</a>
    </li>
    <li>
      <a href="../articles/lca_exploratory.html">Exploratory LPA for Ocean Microplastics</a>
    </li>
    <li>
      <a href="../articles/lca_lcga.html">Latent Class Growth Analysis</a>
    </li>
    <li>
      <a href="../articles/lca_ordinal.html">Latent Class Analysis for Ordinal Indicators</a>
    </li>
    <li>
      <a href="../articles/Plotting_graphs.html">Plotting graphs for structural equation models</a>
    </li>
    <li>
      <a href="../articles/sem_graph.html">SEM graphing conventions</a>
    </li>
    <li>
      <a href="../articles/Tabulating_results.html">Tabulating results from structural equation models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cjvanlissa/tidySEM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Confirmatory LPA for the Caregiver Compass</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cjvanlissa/tidySEM/blob/HEAD/vignettes/lca_confirmatory.Rmd" class="external-link"><code>vignettes/lca_confirmatory.Rmd</code></a></small>
      <div class="hidden name"><code>lca_confirmatory.Rmd</code></div>

    </div>

    
    
<p>This is an example of confirmatory LPA using <code>tidySEM</code>.
The simulated data are based on work by Zegwaard and colleagues, who
sought to establish a typology of caregivers who support a close other
receiving outpatient psychological care. Qualitative research among
experts resulted in a theory postulating the existence of four types of
caregivers (translated from the original Dutch):</p>
<p><strong>Balanced</strong></p>
<blockquote>
<p>The balanced caregiver experiences relative balance between the costs
and benefits of caring for a close other.</p>
</blockquote>
<p><strong>Imbalanced</strong></p>
<blockquote>
<p>The imbalanced caregiver experiences a precarious balance between the
costs and benefits of caring for a close other.</p>
</blockquote>
<p><strong>Lonely</strong></p>
<blockquote>
<p>The lonely caregiver experiences a strong sense of isolation.</p>
</blockquote>
<p><strong>Entrapped</strong></p>
<blockquote>
<p>The entrapped caregiver strongly feels a sense of being entangled in
responsibilities which are difficult to fulfill.</p>
</blockquote>
<p>The goal of this confirmatory study was to validate this hypothesized
class solution in a sample of caregivers. A convenience sample was used,
with no prior sample size justification. To view the data documentation,
run the command <code><a href="../reference/zegwaard_carecompass.html">?tidySEM::zegwaard_carecompass</a></code> in the R
console.</p>
<div class="section level2">
<h2 id="loading-the-data">Loading the Data<a class="anchor" aria-label="anchor" href="#loading-the-data"></a>
</h2>
<p>To load the data, simply attach the <code>tidySEM</code> package. For
convenience, we assign the variables used for analysis to an object
called <code>df</code>. We first only use the four scales:
<code>c("burdened", "trapped", "negaffect", "loneliness")</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cjvanlissa.github.io/tidySEM/" class="external-link">tidySEM</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co"># Load data</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">zegwaard_carecompass</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"burdened"</span>, <span class="st">"trapped"</span>, <span class="st">"negaffect"</span>, <span class="st">"loneliness"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="descriptive-statistics">Descriptive statistics<a class="anchor" aria-label="anchor" href="#descriptive-statistics"></a>
</h2>
<p>We use <code><a href="../reference/descriptives.html">tidySEM::descriptives()</a></code> to describe the data
numerically. Because all scales are continuous, we select only columns
for continuous data to de-clutter the table:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">desc</span> <span class="op">&lt;-</span> <span class="fu">tidySEM</span><span class="fu">::</span><span class="fu"><a href="../reference/descriptives.html">descriptives</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">desc</span> <span class="op">&lt;-</span> <span class="va">desc</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"n"</span>, <span class="st">"missing"</span>, <span class="st">"unique"</span>,</span>
<span>                 <span class="st">"mean"</span>, <span class="st">"median"</span>, <span class="st">"sd"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>,</span>
<span>                 <span class="st">"skew_2se"</span>, <span class="st">"kurt_2se"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">desc</span></span></code></pre></div>
<table class="table">
<caption>Descriptive statistics</caption>
<colgroup>
<col width="14%">
<col width="5%">
<col width="10%">
<col width="9%">
<col width="6%">
<col width="9%">
<col width="6%">
<col width="8%">
<col width="5%">
<col width="12%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">name</th>
<th align="right">n</th>
<th align="right">missing</th>
<th align="right">unique</th>
<th align="right">mean</th>
<th align="right">median</th>
<th align="right">sd</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">skew_2se</th>
<th align="right">kurt_2se</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">burdened</td>
<td align="right">509</td>
<td align="right">0.01</td>
<td align="right">509</td>
<td align="right">3.4</td>
<td align="right">3.4</td>
<td align="right">0.75</td>
<td align="right">1.20</td>
<td align="right">5.3</td>
<td align="right">0.17</td>
<td align="right">6.5</td>
</tr>
<tr class="even">
<td align="left">trapped</td>
<td align="right">505</td>
<td align="right">0.02</td>
<td align="right">505</td>
<td align="right">1.7</td>
<td align="right">1.8</td>
<td align="right">0.90</td>
<td align="right">-0.86</td>
<td align="right">3.8</td>
<td align="right">-1.03</td>
<td align="right">5.4</td>
</tr>
<tr class="odd">
<td align="left">negaffect</td>
<td align="right">506</td>
<td align="right">0.01</td>
<td align="right">506</td>
<td align="right">2.5</td>
<td align="right">2.5</td>
<td align="right">0.69</td>
<td align="right">0.71</td>
<td align="right">5.0</td>
<td align="right">0.08</td>
<td align="right">6.5</td>
</tr>
<tr class="even">
<td align="left">loneliness</td>
<td align="right">510</td>
<td align="right">0.01</td>
<td align="right">510</td>
<td align="right">2.7</td>
<td align="right">2.7</td>
<td align="right">0.62</td>
<td align="right">0.98</td>
<td align="right">4.2</td>
<td align="right">-0.33</td>
<td align="right">6.3</td>
</tr>
</tbody>
</table>
<p>The table indicates two potential causes for concern: there is a
small percentage of missingness, and all variables have relatively high
kurtosis. Since there are some missing values, we can conduct an MCAR
test using <code>mice::mcar(df)</code>. According to Hawkinsâ€™ test,
there is no evidence to reject the assumptions of multivariate normality
and MCAR, <span class="math inline">\(\tilde{\chi^2}(6) = 3.78,
\tilde{p} = 0.71\)</span>. Missing data will be accounted for using
FIML.</p>
<p>Additionally, we can plot the data. The <code>ggplot2</code> function
<code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density()</a></code> is useful for continuous data. Visual
inspection confirms the conclusions from the <code><a href="../reference/descriptives.html">descriptives()</a></code>
table: the data are kurtotic (peaked).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_plot</span> <span class="op">&lt;-</span> <span class="va">df</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_plot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Value."</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_plot</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></span><span class="op">(</span><span class="va">df_plot</span>, varying <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_plot</span><span class="op">)</span>, direction <span class="op">=</span> <span class="st">"long"</span>,</span>
<span>                   timevar <span class="op">=</span> <span class="st">"Variable"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Variable</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="plot_lpa_desc.png" width="80%"></p>
</div>
<div class="section level2">
<h2 id="conducting-latent-profile-analysis">Conducting Latent Profile Analysis<a class="anchor" aria-label="anchor" href="#conducting-latent-profile-analysis"></a>
</h2>
<p>As all variables are continuous, we can use the convenience function
<code><a href="../reference/mx_profiles.html">tidySEM::mx_profiles()</a></code>, which is a wrapper for the generic
function <code><a href="../reference/mx_mixture.html">mx_mixture()</a></code> optimized for continuous indicators.
Its default settings are appropriate for LPA, assuming fixed variances
across classes and zero covariances. Its arguments are <code>data</code>
and number of <code>classes</code>. All variables in <code>data</code>
are included in the analysis, which is why we first selected the
indicator variables. As this is a confirmatory LCA, we do not follow a
strictly data-driven class enumeration procedure. We will set the
maximum number of classes <span class="math inline">\(K\)</span> to one
more than the theoretically expected number. We set a seed to ensure
replicable results.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mx_profiles.html">mx_profiles</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>,</span>
<span>                   classes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>This analysis should produce some messages about cluster
initialization. These relate to the selection of starting values, which
relies on the K-means algorithm and is not robust to missing data. The
algorithm automatically switches to hierarchical clustering, no further
action is required.</p>
</div>
<div class="section level2">
<h2 id="class-enumeration">Class Enumeration<a class="anchor" aria-label="anchor" href="#class-enumeration"></a>
</h2>
<p>To compare the fit of the theoretical model against other models, we
create a model fit table using <code><a href="../reference/table_fit.html">table_fit()</a></code> and retain
relevant columns. We also determine whether any models can be
disqualified.</p>
<p>In this example, all models converge without issues. If, for example,
the two-class solution had not converged, we could use the function
<code>res[[2]] &lt;- mxTryHard(res[[2]])</code> to aid convergence.</p>
<p>Next, we check for local identifiability. The sample size is
consistently reported as 513, which means that partially missing cases
were indeed included via FIML. The smallest class size occurs in the
5-class model, where the smallest class is assigned 7% of cases, or 38
cases. This model has 28 parameters, approximately 6 per class. We thus
have at least five observations per parameter in every class, and do not
disqualify the 5-class model.</p>
<p>There are concerns about theoretical interpretability of all
solutions, as the entropies and minimum classification probabilities are
all low. However, in this confirmatory use case, we address this when
interpreting the results.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/table_fit.html">table_fit</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="co"># model fit table</span></span>
<span><span class="va">fit</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Name"</span>, <span class="st">"LL"</span>, <span class="st">"Parameters"</span>, <span class="st">"n"</span>,</span>
<span>         <span class="st">"BIC"</span>, <span class="st">"Entropy"</span>,</span>
<span>         <span class="st">"prob_min"</span>, <span class="st">"prob_max"</span>, </span>
<span>         <span class="st">"n_min"</span>, <span class="st">"n_max"</span>,</span>
<span>         <span class="st">"np_ratio"</span>, <span class="st">"np_local"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<table class="table">
<caption>Model fit table</caption>
<colgroup>
<col width="19%">
<col width="9%">
<col width="4%">
<col width="6%">
<col width="8%">
<col width="12%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="left">Name</th>
<th align="right">LL</th>
<th align="right">p</th>
<th align="right">n</th>
<th align="right">BIC</th>
<th align="right">Entropy</th>
<th align="right">p_min</th>
<th align="right">p_max</th>
<th align="right">n_min</th>
<th align="right">n_max</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">equal var 1</td>
<td align="right">-2242</td>
<td align="right">8</td>
<td align="right">513</td>
<td align="right">4534</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">equal var 2</td>
<td align="right">-2031</td>
<td align="right">13</td>
<td align="right">513</td>
<td align="right">4144</td>
<td align="right">0.74</td>
<td align="right">0.91</td>
<td align="right">0.93</td>
<td align="right">0.42</td>
<td align="right">0.58</td>
</tr>
<tr class="odd">
<td align="left">equal var 3</td>
<td align="right">-1951</td>
<td align="right">18</td>
<td align="right">513</td>
<td align="right">4015</td>
<td align="right">0.78</td>
<td align="right">0.89</td>
<td align="right">0.91</td>
<td align="right">0.19</td>
<td align="right">0.54</td>
</tr>
<tr class="even">
<td align="left">equal var 4</td>
<td align="right">-1916</td>
<td align="right">23</td>
<td align="right">513</td>
<td align="right">3976</td>
<td align="right">0.75</td>
<td align="right">0.81</td>
<td align="right">0.92</td>
<td align="right">0.16</td>
<td align="right">0.34</td>
</tr>
<tr class="odd">
<td align="left">equal var 5</td>
<td align="right">-1912</td>
<td align="right">28</td>
<td align="right">513</td>
<td align="right">3999</td>
<td align="right">0.79</td>
<td align="right">0.81</td>
<td align="right">0.92</td>
<td align="right">0.00</td>
<td align="right">0.34</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="using-ics">Using ICs<a class="anchor" aria-label="anchor" href="#using-ics"></a>
</h3>
<p>the 4-class solution has the lowest BIC, which means it is preferred
over all other solutions including a 1-class solution and a solution
with more classes. Note that a scree plot for the BIC can be plotted by
calling <code>plot(fit)</code>. Following the elbow criterion, a
three-class solution would also be defensible. The function
<code>ic_weights(tab_compare)</code> allows us to compute IC weights; it
indicates that, conditional on the set of models, the 4-class model has
a posterior model probability of nearly 100%.</p>
</div>
<div class="section level3">
<h3 id="using-lmr-tests">Using LMR tests<a class="anchor" aria-label="anchor" href="#using-lmr-tests"></a>
</h3>
<p>If we conduct LMR tests, we find that the tests are significant for
all pairwise model comparisons, except for the 5-class model:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lr_lmr.html">lr_lmr</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>LMR test table</caption>
<thead><tr class="header">
<th align="left">Null</th>
<th align="left">Alt</th>
<th align="right">lr</th>
<th align="right">lmr_lr</th>
<th align="right">df</th>
<th align="right">lmr_p</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left">equal var 1</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">equal var 1</td>
<td align="left">equal var 2</td>
<td align="right">421.2</td>
<td align="right">399.9</td>
<td align="right">5</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">equal var 2</td>
<td align="left">equal var 3</td>
<td align="right">160.0</td>
<td align="right">151.9</td>
<td align="right">5</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">equal var 3</td>
<td align="left">equal var 4</td>
<td align="right">70.2</td>
<td align="right">66.6</td>
<td align="right">5</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">equal var 4</td>
<td align="left">equal var 5</td>
<td align="right">7.8</td>
<td align="right">7.4</td>
<td align="right">5</td>
<td align="right">0.19</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="using-blrt-tests">Using BLRT tests<a class="anchor" aria-label="anchor" href="#using-blrt-tests"></a>
</h3>
<p>We can also use the BLRT test. As it is very computationally
expensive, we will use a low number of replications here. In practice,
one might use a much higher number (1000+) for published research. Keep
in mind that the p-value of the BLRT is subject to Monte Carlo error; if
it fluctuates when analyses are replicated or its value is very close to
the critical threshold, consider increasing the number of
replications.</p>
<p>To accelerate computations, we can use the <code>future</code>
package for parallel computing (see <code><a href="https://future.futureverse.org/reference/plan.html" class="external-link">?plan</a></code> to select the
appropriate back-end for your system). To track the functionâ€™s progress,
we use the <code>progressr</code> ecosystem, which allows users to
choose how they want to be informed. The example below uses a progress
bar:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://progressr.futureverse.org" class="external-link">progressr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span> <span class="co"># Parallel processing for Windows</span></span>
<span><span class="fu"><a href="https://progressr.futureverse.org/reference/handlers.html" class="external-link">handlers</a></span><span class="op">(</span><span class="st">"progress"</span><span class="op">)</span> <span class="co"># Progress bar</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">res_blrt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BLRT.html">BLRT</a></span><span class="op">(</span><span class="va">res</span>, replications <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>BLRT test table</caption>
<thead><tr class="header">
<th align="left">null</th>
<th align="left">alt</th>
<th align="right">lr</th>
<th align="right">df</th>
<th align="right">blrt_p</th>
<th align="right">samples</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">mix1</td>
<td align="left">mix2</td>
<td align="right">421.2</td>
<td align="right">5</td>
<td align="right">0.00</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="left">mix2</td>
<td align="left">mix3</td>
<td align="right">160.0</td>
<td align="right">5</td>
<td align="right">0.00</td>
<td align="right">20</td>
</tr>
<tr class="even">
<td align="left">mix3</td>
<td align="left">mix4</td>
<td align="right">70.2</td>
<td align="right">5</td>
<td align="right">0.00</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="left">mix4</td>
<td align="left">mix5</td>
<td align="right">7.8</td>
<td align="right">5</td>
<td align="right">0.55</td>
<td align="right">20</td>
</tr>
</tbody>
</table>
<p>In sum, across all class enumeration criteria, there is strong
support for a 4-class solution.</p>
</div>
</div>
<div class="section level2">
<h2 id="optional-alternative-model-specifications">Optional: Alternative Model Specifications<a class="anchor" aria-label="anchor" href="#optional-alternative-model-specifications"></a>
</h2>
<p>In the case of confirmatory LCA, the theory would be refuted by
strong evidence against the hypothesized model and number of classes. In
the preceding, we only compared the theoretical model against models
with different number of classes. Imagine, however, that a Reviewer
argues that variance ought to be freely estimated across classes. We
could compare our theoretical model against their competing model as
follows. Note that we can put two models into a list to compare
them.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_alt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mx_profiles.html">mx_profiles</a></span><span class="op">(</span><span class="va">df</span>, classes <span class="op">=</span> <span class="fl">4</span>, variances <span class="op">=</span> <span class="st">"varying"</span><span class="op">)</span></span>
<span><span class="va">compare</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">res</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>, <span class="va">res_alt</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/table_fit.html">table_fit</a></span><span class="op">(</span><span class="va">compare</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Comparing competing theoretical models</caption>
<colgroup>
<col width="7%">
<col width="9%">
<col width="16%">
<col width="7%">
<col width="12%">
<col width="13%">
<col width="13%">
<col width="9%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="right">Name</th>
<th align="right">LL</th>
<th align="right">Parameters</th>
<th align="right">BIC</th>
<th align="right">Entropy</th>
<th align="right">prob_min</th>
<th align="right">prob_max</th>
<th align="right">n_min</th>
<th align="right">n_max</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">-1916</td>
<td align="right">23</td>
<td align="right">3976</td>
<td align="right">0.75</td>
<td align="right">0.81</td>
<td align="right">0.92</td>
<td align="right">0.16</td>
<td align="right">0.34</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">-1909</td>
<td align="right">35</td>
<td align="right">4037</td>
<td align="right">0.78</td>
<td align="right">0.84</td>
<td align="right">0.92</td>
<td align="right">0.16</td>
<td align="right">0.32</td>
</tr>
</tbody>
</table>
<p>The alternative model incurs 12 additional parameters for the free
variances. Yet, it has a higher BIC, which indicates that this
additional complexity does not outweigh the increase in fit.</p>
</div>
<div class="section level2">
<h2 id="interpreting-the-final-class-solution">Interpreting the Final Class Solution<a class="anchor" aria-label="anchor" href="#interpreting-the-final-class-solution"></a>
</h2>
<p>To interpret the final class solution, we first reorder the 4-class
model by class size. This helps prevent label switching.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mx_switch_labels.html">mx_switch_labels</a></span><span class="op">(</span><span class="va">res</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>The 4-class model yielded classes of reasonable size; using
<code>class_pro</code>the largest class comprised 33%, and the smallest
comprised 16% of cases. However, the entropy was low, <span class="math inline">\(S = .75\)</span>, indicating poor class
separability. Furthermore, the posterior classification probability
ranged from <span class="math inline">\([.81, .92]\)</span>, which means
that at least some classes had a high classification error. We produce a
table of the results below.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/table_results.html">table_results</a></span><span class="op">(</span><span class="va">res_final</span>, columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"label"</span>, <span class="st">"est"</span>, <span class="st">"se"</span>, <span class="st">"confint"</span>, <span class="st">"class"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Four-class model results</caption>
<thead><tr class="header">
<th align="left">label</th>
<th align="right">est</th>
<th align="right">se</th>
<th align="left">confint</th>
<th align="left">class</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">mix4.weights[1,2]</td>
<td align="right">0.86</td>
<td align="right">0.15</td>
<td align="left">[0.56, 1.15]</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">mix4.weights[1,3]</td>
<td align="right">0.66</td>
<td align="right">0.11</td>
<td align="left">[0.44, 0.88]</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">mix4.weights[1,4]</td>
<td align="right">0.47</td>
<td align="right">0.08</td>
<td align="left">[0.32, 0.63]</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Variances.burdened</td>
<td align="right">0.23</td>
<td align="right">0.02</td>
<td align="left">[0.19, 0.27]</td>
<td align="left">class1</td>
</tr>
<tr class="odd">
<td align="left">Variances.trapped</td>
<td align="right">0.17</td>
<td align="right">0.02</td>
<td align="left">[0.14, 0.20]</td>
<td align="left">class1</td>
</tr>
<tr class="even">
<td align="left">Variances.negaffect</td>
<td align="right">0.31</td>
<td align="right">0.02</td>
<td align="left">[0.27, 0.36]</td>
<td align="left">class1</td>
</tr>
<tr class="odd">
<td align="left">Variances.loneliness</td>
<td align="right">0.24</td>
<td align="right">0.02</td>
<td align="left">[0.20, 0.28]</td>
<td align="left">class1</td>
</tr>
<tr class="even">
<td align="left">Means.burdened</td>
<td align="right">3.27</td>
<td align="right">0.04</td>
<td align="left">[3.18, 3.36]</td>
<td align="left">class1</td>
</tr>
<tr class="odd">
<td align="left">Means.trapped</td>
<td align="right">1.28</td>
<td align="right">0.05</td>
<td align="left">[1.18, 1.38]</td>
<td align="left">class1</td>
</tr>
<tr class="even">
<td align="left">Means.negaffect</td>
<td align="right">2.31</td>
<td align="right">0.06</td>
<td align="left">[2.20, 2.42]</td>
<td align="left">class1</td>
</tr>
<tr class="odd">
<td align="left">Means.loneliness</td>
<td align="right">2.73</td>
<td align="right">0.04</td>
<td align="left">[2.64, 2.82]</td>
<td align="left">class1</td>
</tr>
<tr class="even">
<td align="left">Means.burdened</td>
<td align="right">3.40</td>
<td align="right">0.06</td>
<td align="left">[3.28, 3.52]</td>
<td align="left">class2</td>
</tr>
<tr class="odd">
<td align="left">Means.trapped</td>
<td align="right">2.27</td>
<td align="right">0.06</td>
<td align="left">[2.15, 2.38]</td>
<td align="left">class2</td>
</tr>
<tr class="even">
<td align="left">Means.negaffect</td>
<td align="right">2.81</td>
<td align="right">0.06</td>
<td align="left">[2.70, 2.93]</td>
<td align="left">class2</td>
</tr>
<tr class="odd">
<td align="left">Means.loneliness</td>
<td align="right">2.79</td>
<td align="right">0.06</td>
<td align="left">[2.66, 2.91]</td>
<td align="left">class2</td>
</tr>
<tr class="even">
<td align="left">Means.burdened</td>
<td align="right">4.25</td>
<td align="right">0.07</td>
<td align="left">[4.12, 4.38]</td>
<td align="left">class3</td>
</tr>
<tr class="odd">
<td align="left">Means.trapped</td>
<td align="right">2.67</td>
<td align="right">0.05</td>
<td align="left">[2.58, 2.77]</td>
<td align="left">class3</td>
</tr>
<tr class="even">
<td align="left">Means.negaffect</td>
<td align="right">2.92</td>
<td align="right">0.06</td>
<td align="left">[2.80, 3.03]</td>
<td align="left">class3</td>
</tr>
<tr class="odd">
<td align="left">Means.loneliness</td>
<td align="right">2.01</td>
<td align="right">0.06</td>
<td align="left">[1.89, 2.14]</td>
<td align="left">class3</td>
</tr>
<tr class="even">
<td align="left">Means.burdened</td>
<td align="right">2.38</td>
<td align="right">0.06</td>
<td align="left">[2.26, 2.50]</td>
<td align="left">class4</td>
</tr>
<tr class="odd">
<td align="left">Means.trapped</td>
<td align="right">0.38</td>
<td align="right">0.05</td>
<td align="left">[0.28, 0.49]</td>
<td align="left">class4</td>
</tr>
<tr class="even">
<td align="left">Means.negaffect</td>
<td align="right">1.78</td>
<td align="right">0.07</td>
<td align="left">[1.65, 1.91]</td>
<td align="left">class4</td>
</tr>
<tr class="odd">
<td align="left">Means.loneliness</td>
<td align="right">3.18</td>
<td align="right">0.06</td>
<td align="left">[3.07, 3.30]</td>
<td align="left">class4</td>
</tr>
</tbody>
</table>
<p>The results are best interpreted by examining a plot of the model and
data, however. Relevant plot functions are
<code><a href="../reference/plot_bivariate.html">plot_bivariate()</a></code>, <code><a href="../reference/plot_density.html">plot_density()</a></code>, and
<code><a href="../reference/plot_profiles.html">plot_profiles()</a></code>. However, we omit the density plots,
because <code><a href="../reference/plot_bivariate.html">plot_bivariate()</a></code> also includes them.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_bivariate.html">plot_bivariate</a></span><span class="op">(</span><span class="va">res_final</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="lpa_bivariate.png" alt="Bivariate profile plot" width="80%"><p class="caption">
Bivariate profile plot
</p>
</div>
<p>On the diagonal of the bivariate plot are weighted density plots:
normal approximations of the density function of observed data, weighed
by class probability. On the off-diagonal are plots for each pair of
indicators, with the class means indicated by a point, class standard
deviations indicated by lines, and covariances indicated by circles. As
this model has zero covariances, all circles are round (albeit warped by
the different scales of the X and Y axes)</p>
<p>The marginal density plots show that trappedness distinguishes
classes rather well. For all other indicators, groups are not always
clearly separated in terms of marginal density: class 2 and 3 coalesce
on negative affect, 1 and 2 coalesce on loneliness, and 1 and 2 coalesce
on burden. Nevertheless, the off-diagonal scatterplots show reasonable
bivariate separation for all classes.</p>
<p>We can obtain a more classic profile plot using
<code>plot_profiles(res_final)</code>. This plot conveys less
information than the bivariate plot, but is readily interpretable. Below
is a comparison between the most common type of visualization for LPA,
and the best-practices visualization provided by <code>tidySEM</code>.
Note that the best practices plot includes class means and error bars,
standard deviations, and a ribbon plot of raw data weighted by class
probability to indicate how well the classes describe the observed
distribution. The overlap between the classes is clearly visible in this
figure; this is why the entropy and classification probabilities are
relatively low.</p>
<p>Based on the bivariate plot, we can label class 1 as the
<em>balanced</em> type (33%), class 2 as the <em>imbalanced</em> type
(29%), class 3 as the <em>entrapped</em> type (22%), and class 4 as the
<em>lonely</em> type (16%). Note however that the observed classes do
not match the hypothesized pattern of class parameters exactly.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_profiles.html">plot_profiles</a></span><span class="op">(</span><span class="va">res_final</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="lpa_profiles.png" alt="Bivariate profile plot" width="80%"><p class="caption">
Bivariate profile plot
</p>
</div>
</div>
<div class="section level2">
<h2 id="auxiliary-analyses">Auxiliary Analyses<a class="anchor" aria-label="anchor" href="#auxiliary-analyses"></a>
</h2>
<p>We may want to compare the different classes on auxiliary variables
or models. The <code><a href="../reference/BCH.html">BCH()</a></code> function applies three-step analysis,
which compares the classes using a multi-group model, controlling for
classification error. We consider two examples: a single variable, and
an auxiliary model.</p>
<div class="section level3">
<h3 id="comparing-means-or-proportions-across-classes">Comparing Means or Proportions Across Classes<a class="anchor" aria-label="anchor" href="#comparing-means-or-proportions-across-classes"></a>
</h3>
<p>For a single (continuous or ordinal) variable, we can call the BCH
function and simply supply the auxiliary variable to the
<code>data</code> argument, omitting the <code>model</code> argument.
Below, we estimate an auxiliary model to compare the sex of patients
between classes:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aux_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BCH.html">BCH</a></span><span class="op">(</span><span class="va">res_final</span>, data <span class="op">=</span> <span class="va">zegwaard_carecompass</span><span class="op">$</span><span class="va">sexpatient</span><span class="op">)</span></span></code></pre></div>
<p>To obtain an omnibus likelihood ratio test of the significance of
these sex differences across classes, as well as pairwise comparisons
between classes, use <code>lr_test(aux_sex)</code>. The results indicate
that there are significant sex differences across classes, <span class="math inline">\(\Delta LL(1) = 8.7, p = .003\)</span>. Pairwise
comparisons indicate that class 3 differs significantly from classes 1
and 2. The results can be reported in probability scale using
<code>table_prob(aux_sex)</code>. It appears that the entrapped class
disproportionately cares for female patients.</p>
</div>
<div class="section level3">
<h3 id="comparing-auxiliary-models-across-classes">Comparing Auxiliary Models Across Classes<a class="anchor" aria-label="anchor" href="#comparing-auxiliary-models-across-classes"></a>
</h3>
<p>We can also compare a simple model between classes. Specifically, we
will examine whether the distance predicts the frequency of visits
differently across classes (treated as continuous).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_aux</span> <span class="op">&lt;-</span> <span class="va">zegwaard_carecompass</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"freqvisit"</span>, <span class="st">"distance"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">df_aux</span><span class="op">$</span><span class="va">freqvisit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">df_aux</span><span class="op">$</span><span class="va">freqvisit</span><span class="op">)</span></span>
<span><span class="va">aux_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BCH.html">BCH</a></span><span class="op">(</span><span class="va">res_final</span>, model <span class="op">=</span> <span class="st">"freqvisit ~ distance"</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">df_aux</span><span class="op">)</span></span></code></pre></div>
<p>To obtain an omnibus likelihood ratio test of the difference in
regression coefficients across classes and pairwise comparisons between
classes, use <code>lr_test(aux_model, compare = "A")</code>. The results
indicate that there are no significant sex differences across classes,
<span class="math inline">\(\Delta LL(3) = 0.98, p = .81\)</span>. The
results can be reported using <code>table_results(aux_model)</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="predicting-class-membership">Predicting class membership<a class="anchor" aria-label="anchor" href="#predicting-class-membership"></a>
</h2>
<p>This LCA model was developed to help classify care providers in a
clinical context, so that mental healthcare professionals can provide
tailored support to those who take care of their clients. In
<code>tidySEM</code>, it is possible to predict class membership for new
data. Imagine that we administer the care compass questionnaire to a new
individual. We can assign their scale scores to a
<code>data.frame</code>, and supply it to the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>
function via the <code>newdata</code> argument. The result includes the
individualâ€™s most likely class, as well as posterior probabilities for
all classes.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  burdened <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  trapped <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  negaffect <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  loneliness <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res_final</span>, newdata <span class="op">=</span> <span class="va">df_new</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;       class1  class2 class3  class4 predicted</span></span>
<span><span class="co">#&gt; [1,] 0.00081 1.4e-15      1 4.6e-08         3</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Caspar J. van Lissa.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
